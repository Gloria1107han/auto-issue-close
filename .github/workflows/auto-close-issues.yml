name: Auto Close Issues

on:
  issues:
    types: [labeled, opened]

jobs:
  close-issue:
    runs-on: ubuntu-latest
    permissions:
      issues: write
    steps:
      - name: Debug - Print event data
        run: |
          echo "Event name: ${{ github.event_name }}"
          echo "Issue number: ${{ github.event.issue.number }}"
          echo "Issue labels: ${{ github.event.issue.labels.*.name }}"
          echo "Action: ${{ github.event.action }}"
          
      - name: Close issue if labeled completed or wontfix
        if: contains(github.event.issue.labels.*.name, 'completed') || contains(github.event.issue.labels.*.name, 'wontfix')
        run: |
          echo "Closing issue #${{ github.event.issue.number }}"
          gh issue close ${{ github.event.issue.number }} --repo ${{ github.repository }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}